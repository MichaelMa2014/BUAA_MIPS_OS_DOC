Lab1 实验报告
----------------
### 学习使用工具
在 Lab1 中我们学习了各种工具，包括

- `ssh`
- `vim`
- `git`
- `Markdown`

这份报告首先介绍学习这些工具的一些心得。

`ssh` 是最常用的安全连接工具，可以用于远程登录到服务器。登录后使用 `passwd` 可以方便地修改密码。

`vim` 号称最“强大”的文本编辑器，使用中遇到的主要问题是缓存文件如何处理。`Vim` 在打开一个文件是会自动创建后缀名为 `swp` 的缓存文件，如果没有正确关闭，比如与服务器的连接断开了，那么下一次打开时这个缓存文件还会存在，此时 `Vim` 就会报错，询问用户如何处理上次编辑的结果。有时候有 `D` 选项，可以直接删除缓存文件，有时候则只有 `R` 和 `Q` 等选项，分别用于“恢复”和“退出”。此时需要在退出后手动使用 `rm` 命令删除缓存文件才能继续正确运行。

`git` 使用中主要遇到的是如何在服务器和本地之间交换数据的问题。比较难以理解的是为什么 `push` 和 `pull` 操作都只针对于当前所在的分支，而不是整个仓库。而且对于 `git status` 中显示的 `1 commit ahead of` 至今没有理解。

`Markdown` 是一种方便书写格式化的文本的语言，比如 使用 \` \` 反引号可以快速输入代码，一行减号就是一个水平分割线。它同时支持在文本中包含链接，比如<a href="https://www.facebook.com/MichaelMa2014"> 这样 </a>。

### 阅读和补全代码
第一次实验中最困难的应该就是填写 `print.c` 中空缺的部分了，这简直是编译器做的工作。我主要遇到了这些困难

- 什么是 `va_list` ？
- 为什么都写完了还不对？

接下来我将会一一介绍我是如何解决这些问题的。

首先使用 `grep` 查找 `va_list`，发现它只出现在了 `compiler` 文件夹下，也就是不是由我们定义的。那么直接这样使用为什么不会出现编译错误呢？
注意到 `include <print.h>` ，是不是在这里定义了 `va_list` 呢？打开这个文件，发现并没有它的定义，但是可以看到 `include <stdarg.h>` ，我这才意识到，这可能是一个 <a href =http://www.cplusplus.com/reference/cstdarg/>C 标准库</a>。
其实看到 `Compiler` 文件夹下也出现 `va_list` 时我就应该意识到了。
原来这个标准库是专门为 `printf` 这样的有不确定数量的函数准备的，而库中定义的 `va_list` 则是专门存储 "variant"（变量） 的 "list"（列表）。
在后面用到的 `va_arg` 也是这个库中定义的，用于从变量列表中取出下一个变量。

接下来我按顺序判断了 `flags`，`width`，`precision` 和 `long`，但是运行时会输出`panic at -2147415180: ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^`，注意到 `panic` 的代码中有 `%s%d`，可以看出我的 `print` 函数没有正确输出，连基本的没有任何格式修饰符的 `%s%d` 都没有正确处理。经过艰苦卓绝的努力，我发现我在某一个 `if` 判断中把双等号写成了单等号……

### 研究思考题
#### 小明的困境

删除的文件能否找回，取决于**该文件**在 `git` 中的状态。

- `Untracked` 无法找回
- `To be committed` 可以使用 `git checkout -- print.c` 找回
- `Committed` 可以使用 `git checkout -- print.c` 找回

接下来的讨论中假设该文件已经被 `commit` 过了。

如果已经执行了 `git rm print.c`，相当于这个文件的**删除**已经被 `git add`，进入了 `To be committed` 的状态，此时需要先将这次修改取消。可以使用 `git reset HEAD print.c`。然后使用 `git checkout -- print.c` 找回。

添加到暂存区的文件如果想要删除，可以使用 `git rm --cached Tucao.txt`。

#### 克隆命令

根据 <a href="http://web.mit.edu/~mkgray/project/silk/root/afs/sipb/project/git/git-doc/git-clone.html"> 这篇文章 </a> 的说法，我认为 1，2 和 4 是正确的。

### 难度评估
这次的实验我总共花费了大约 10 小时。包括 4 小时学习 `ssh`，`vim`，`git` 和 `Markdown` 等工具，2 小时完成 `start.S`，连接器脚本，交叉编译器定位三个文件，3 小时完成 `print.c`，和 2 小时完成实验报告。
